```
class Solution:
    def printMatrix(self, matrix):
        # write code here
        ans = [matrix[0][0]]
        r, c = len(matrix), len(matrix[0])
        rd = [0, 1, 0, -1]
        cd = [1, 0, -1, 0]
        d = {(0, 0):1}
        i, j, p = 0, 0, 0
        for _ in range(r*c-1):
            ic, jc = i + rd[p], j + cd[p]
            if 0 <= ic < r and 0 <= jc < c and (ic, jc) not in d:
                i, j = ic, jc
            else:
                p = (p + 1) % 4
                i, j = i + rd[p], j + cd[p]
            d[(i, j)] = 1
            ans.append(matrix[i][j])
        return ans
```
