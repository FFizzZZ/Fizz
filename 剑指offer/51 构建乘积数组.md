```
class Solution:
    def multiply(self, A):
        l, u, n, B = [1], [1], len(A), []
        for i in range(n-1):
            l.append(l[-1] * A[i])
            u.append(u[-1] * A[~i])
        for i in range(n):
            B.append(l[i] * u[~i])
        return B
```

## Optimized
```
class Solution:
    def multiply(self, A):
        B = [1] * len(A)
        for i in range(len(A) - 1):
            B[i + 1] = B[i] * A[i]
        cur = 1
        for i in range(len(A) - 1, -1, -1):
            B[i] *= cur 
            cur *= A[i]
        return B
```
