```
class Solution:
    def __init__(self):
        self.maxheap = []
        self.minheap = []
        self.count = 0
    def Insert(self, num):
        if not self.maxheap: 
            self.maxheap.append(num)
        elif not self.minheap:
            self.minheap.append(max(self.maxheap[0], num))
            self.maxheap[0] = min(self.maxheap[0], num)
        else:
            if self.count & 1 == 0:
                if num <= self.minheap[0]: self.maxheap.append(num)
                else:
                    self.maxheap.append(self.minheap[0])
                    self.minheap[0] = num
                    self.mindown(self.minheap, 0)
                self.maxup(self.maxheap, len(self.maxheap)-1)
            else:
                if num >= self.maxheap[0]: self.minheap.append(num)
                else:
                    self.minheap.append(self.maxheap[0])
                    self.maxheap[0] = num
                    self.maxdown(self.maxheap, 0)
                self.minup(self.minheap, len(self.minheap)-1)
        self.count += 1
    def GetMedian(self, n=None):
        if not self.count: return -1
        if self.count & 1 == 0:
            return (self.maxheap[0]+self.minheap[0]+0.0) / 2
        else:
            return self.maxheap[0]
    def maxdown(self, A, i):
        left, right, temp = 2*i+1, 2*i+2, i
        if left < len(A) and A[left] > A[temp]: temp = left
        if right < len(A) and A[right] > A[temp]: temp = right
        if temp != i:
            A[temp], A[i] = A[i], A[temp]
            self.maxdown(A, temp)
    def mindown(self, A, i):
        left, right, temp = 2*i+1, 2*i+2, i
        if left < len(A) and A[left] < A[temp]: temp = left
        if right < len(A) and A[right] < A[temp]: temp = right
        if temp != i:
            A[temp], A[i] = A[i], A[temp]
            self.mindown(A, temp)
    def maxup(self, A, i):
        j = (i-1) / 2
        if j >=0 and A[i] > A[j]: 
            A[i], A[j] = A[j], A[i]
            self.maxup(A, j)
    def minup(self, A, i):
        j = (i-1) / 2
        if j >=0 and A[i] < A[j]:
            A[i], A[j] = A[j], A[i]
            self.minup(A, j)
```
